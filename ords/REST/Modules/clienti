
-- Generated by ORDS REST Data Services 20.3.0.r3011819
-- Schema: MW_ERP  Date: Fri Jan 15 04:49:35 2021 
--

BEGIN
  ORDS.ENABLE_SCHEMA(
      p_enabled             => TRUE,
      p_schema              => 'MW_ERP',
      p_url_mapping_type    => 'BASE_PATH',
      p_url_mapping_pattern => 'mw_erp',
      p_auto_rest_auth      => FALSE);
    
  ORDS.DEFINE_MODULE(
      p_module_name    => 'CLIENTI',
      p_base_path      => '/api-c/',
      p_items_per_page => 0,
      p_status         => 'PUBLISHED',
      p_comments       => NULL);

  ORDS.DEFINE_TEMPLATE(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti/',
      p_priority       => 0,
      p_etag_type      => 'HASH',
      p_etag_query     => NULL,
      p_comments       => NULL);

  ORDS.DEFINE_HANDLER(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti/',
      p_method         => 'GET',
      p_source_type    => 'json/collection',
      p_mimes_allowed  => '',
      p_comments       => NULL,
      p_source         => 
'/*SELECT * FROM CLIENTI WHERE AttivoCliente = -1 AND ROWNUM <= 10
AND (cittacliente = :cittacliente OR NVL(:cittacliente, '' '') = '' '') 
AND (descrizionegruppocliente = :descrizionegruppocliente OR NVL(:descrizionegruppocliente, '' '') = '' '')*/

SELECT * FROM MV_CLIENTI WHERE ATTIVO_CLI = -1 AND ROWNUM <= 100
AND (CITTA_CLI = :cittacliente OR NVL(:cittacliente, '' '') = '' '') 
AND (DESC_GRUPPO_CLI = :descrizionegruppocliente OR NVL(:descrizionegruppocliente, '' '') = '' '')');

  ORDS.DEFINE_TEMPLATE(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti',
      p_priority       => 0,
      p_etag_type      => 'HASH',
      p_etag_query     => NULL,
      p_comments       => NULL);

  ORDS.DEFINE_HANDLER(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti',
      p_method         => 'GET',
      p_source_type    => 'json/collection',
      p_mimes_allowed  => '',
      p_comments       => NULL,
      p_source         => 
'/*SELECT * FROM CLIENTI WHERE attivocliente = -1 AND ROWNUM <= 10*/

SELECT * FROM MV_CLIENTI WHERE attivo_cli = -1 AND ROWNUM <= 100');

  ORDS.DEFINE_TEMPLATE(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti/:societa/:codicecliente/:codicepdc',
      p_priority       => 0,
      p_etag_type      => 'HASH',
      p_etag_query     => NULL,
      p_comments       => NULL);

  ORDS.DEFINE_HANDLER(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti/:societa/:codicecliente/:codicepdc',
      p_method         => 'POST',
      p_source_type    => 'plsql/block',
      p_mimes_allowed  => '',
      p_comments       => NULL,
      p_source         => 
'BEGIN
	insertCliente(
	p_societa                    => :societa,
	p_tipocodicecliente          => :tipocodicecliente,
	p_tipocodicepdc              => :tipocodicepdc,
	p_codicecliente              => :codicecliente,
	p_codicepdc                  => :codicepdc,
	p_partitaivacliente          => :partitaivacliente,
	p_codicefiscalecliente       => :codicefiscalecliente,
	p_ragionebrevecliente        => :ragionebrevecliente,
	p_ragionecliente             => :ragionecliente,
	p_indirizzocliente           => :indirizzocliente,
	p_capcliente                 => :capcliente,
	p_cittacliente               => :cittacliente,
	p_provinciacliente           => :provinciacliente,
	p_areacliente                => :areacliente,
	p_zonacliente                => :zonacliente,
	p_codicenazionecliente       => :codicenazionecliente,
	p_telefonocliente            => :telefonocliente,
	p_faxcliente                 => :faxcliente,
	p_cellularecliente           => :cellularecliente,
	p_telefono2cliente           => :telefono2cliente,
	p_mailcliente                => :mailcliente,
	p_codicelinguacliente        => :codicelinguacliente,
	p_codicetrasportocliente     => :codicetrasportocliente,
	p_codicevettorecliente       => :codicevettorecliente,
	p_codicecategoriacliente     => :codicecategoriacliente,
	p_descrizionecategoriacliente=> :descrizionecategoriacliente,
	p_codicecategoriapdc         => :codicecategoriapdc,
	p_descrizionecategoriapdc    => :descrizionecategoriapdc,
	p_codicegruppocliente        => :codicegruppocliente,
	p_descrizionegruppocliente   => :descrizionegruppocliente,
	p_codiceagentecliente        => :codiceagentecliente,
	p_tipoagentecliente          => :tipoagentecliente,
	p_progressivoagentecliente   => :progressivoagentecliente,
	p_codiceagente2cliente       => :codiceagente2cliente,
	p_tipoagente2cliente         => :tipoagente2cliente,
	p_progressivo2agentecliente  => :progressivo2agentecliente,
	p_codiceagente3cliente       => :codiceagente3cliente,
	p_tipoagente3cliente         => :tipoagente3cliente,
	p_progressivo3agentecliente  => :progressivo3agentecliente,
	p_codiceagente4cliente       => :codiceagente4cliente,
	p_tipoagente4cliente         => :tipoagente4cliente,
	p_progressivo4agentecliente  => :progressivo4agentecliente,
	p_codiceagentepdc            => :codiceagentepdc,
	p_vecchiocodicecliente       => :vecchiocodicecliente,
	p_nuovocodicecliente         => :nuovocodicecliente,
	p_codiceclienteunico         => :codiceclienteunico,
	p_attivazionecliente         => :attivazionecliente,
	p_disdettacliente            => :disdettacliente,
	p_areamanagertecnico         => :areamanagertecnico,
	p_attivocliente              => :attivocliente,
	p_attivopdc                  => :attivopdc,
	p_cessionecredito            => :cessionecredito,
	p_mail2cliente               => :mail2cliente,
	p_microarea                  => :microarea,
	p_microbrick                 => :microbrick,
	p_codcliesterno              => :codcliesterno,
	p_latitudine                 => :latitudine,
	p_longitudine                => :longitudine
	);
END;');

  ORDS.DEFINE_HANDLER(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti/:societa/:codicecliente/:codicepdc',
      p_method         => 'DELETE',
      p_source_type    => 'plsql/block',
      p_mimes_allowed  => '',
      p_comments       => NULL,
      p_source         => 
'DELETE FROM TB_CLIENTI_TMP WHERE cod_cli = :codicecliente AND societa = :societa AND cod_pdc = :codicepdc');

  ORDS.DEFINE_HANDLER(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti/:societa/:codicecliente/:codicepdc',
      p_method         => 'PUT',
      p_source_type    => 'plsql/block',
      p_mimes_allowed  => '',
      p_comments       => NULL,
      p_source         => 
'BEGIN
    updateCliente(
    p_societa           => :societa,
    p_codicecliente     => :codicecliente,
    p_codicepdc         => :codicepdc,
  	p_ragionecliente    => :ragionecliente,
    p_indirizzocliente  => :indirizzocliente,
    p_capcliente        => :capcliente,
    p_cittacliente      => :cittacliente,
    p_provinciacliente  => :provinciacliente,
    p_areacliente       => :areacliente,
    p_zonacliente       => :zonacliente,
    p_telefonocliente   => :telefonocliente ,
    p_faxcliente        => :faxcliente,
    p_cellularecliente  => :cellularecliente,
    p_telefono2cliente  => :telefono2cliente,
    p_mailcliente       => :mailcliente,
    p_attivocliente     => :attivocliente,
    p_attivopdc         => :attivopdc,
    p_mail2cliente      => :mail2cliente,
    p_codcliesterno     => :codcliesterno);
END;');

  ORDS.DEFINE_HANDLER(
      p_module_name    => 'CLIENTI',
      p_pattern        => 'clienti/:societa/:codicecliente/:codicepdc',
      p_method         => 'GET',
      p_source_type    => 'json/collection',
      p_mimes_allowed  => '',
      p_comments       => NULL,
      p_source         => 
'SELECT * FROM MV_CLIENTI WHERE societa = :societa AND cod_cli = :codicecliente AND codicepdc = :cod_pdc AND attivocliente = -1');

    
        
COMMIT;

END;